<!-- Orrifice Meter Experiment to determine the coefficient of discharge (Cd) using the orifice meter-->
<html>
<head>
	<title>Orifice Experiment</title>


<style>
	#child1 {
  position: absolute;
 border: 3px solid blue;
  color: white;
 background-color: black;
  top: 100px;
  left: 400px;
}
	#child2 {
  position: absolute;
 border: 3px solid blue;
  color: white;
 background-color: black;
  top: 100px;
  left: 800px;
}

#Div {
	position: absolute;
	top : 700;
	left: 300;
}

	</style>
</head>
<body>
	<!-- Canvas holding the Experiment Apparatus-->	
	<canvas id = "myCanvas" width = "1000" height = "600" style=" border:10px solid #483d8b ;">This is Canvas</canvas>
	<!-- Canvas Holding Input and Output form-->
	<canvas id = "I_O" width = "1000" height = "250" style=" border:10px solid #483d8b ;">This is Canvas</canvas>
	

	<script>

		var canvas = document.getElementById("myCanvas");
		var ctx = canvas.getContext("2d");
        ctx.font = "20px Bold"
        ctx.fillStyle = "Blue";
        var text = ctx.measureText("Orifice");
        ctx.fillText("Orifice", 100,30);
        ctx.strokeStyle = "#000000";
        ctx.strokeRect(100, 33, text.width,0.3);
        canvas.style.left = "170px";
        canvas.style.position = "absolute";

        function fill_text(font_size, color, text, left, top) // To fill Text in the Canvas (Labeling Part)
        {
        	ctx.font = font_size;
			ctx.fillStyle = color;
			ctx.fillText(text, left, top);
        }
        

        fill_text("10px bold", 'red', "Db", 495, 372);
        fill_text("20px Bold", 'blue', "Upstream Pressure Tap", 200, 200);
        fill_text("20px Bold", 'blue',"(Pa)", 240, 230);
		fill_text("20px bold", 'blue', "Downstream Pressure Tap", 540, 200);
		fill_text("20px Bold", 'blue',"(Pb)", 600, 230);
		fill_text("18px bold", 'blue', "Flow direction", 40, 350);
		fill_text("14px bold", 'blue', "Da", 180, 370);

		

    	function triangle(x, y, x1, y1, x2, y2)		// To add triangles
    	{
    		   	ctx.beginPath();
    			ctx.moveTo(x + 10, y);
    			ctx.lineTo(x1 + 10, y1);
    			ctx.lineTo(x2 + 10, y2);
    			ctx.fill();
		    	ctx.closePath();
		    	ctx.stroke();

    	}
    	triangle(410, 230, 400, 220, 400, 240);
    	triangle(160, 360, 150, 350, 150, 370);
    	triangle(520, 271, 530, 261, 530, 281);
    	triangle(180, 302, 175, 310, 185, 310);
    	triangle(180, 420, 175, 410, 185, 410);

    	 
function draw_line(startX, startY, newX, newY){	// To draw Lines
	ctx.beginPath();
ctx.moveTo(startX + 10, startY);
ctx.lineTo(newX + 10, newY);
ctx.stroke();
}

//Co-ordinates of various lines
	draw_line(195, 300, 410, 300);
	draw_line(410, 300, 410, 200);
	draw_line(416, 200, 416, 300);
	draw_line(416, 300, 510, 300);
	draw_line(510, 300, 510, 200);
	draw_line(516, 200, 516, 300);
	draw_line(516, 300, 810, 300);
	draw_line(195, 425, 810, 425);
	draw_line(460, 300, 460, 355);
	draw_line(470, 300, 470, 355);
	draw_line(460, 355, 470, 355);
	draw_line(460, 425, 460, 380);
	draw_line(470, 425, 470, 380);
	draw_line(460, 380, 470, 380);

	function lines(startX, startY, newX, newY) // Draws Lines
	{
			ctx.beginPath();
			ctx.strokeStyle = "black"
ctx.moveTo(startX + 10, startY);
ctx.lineTo(newX + 10, newY);
ctx.stroke();
	}

	lines(170, 300, 190, 300);
	lines(170, 420, 190, 420);


function line_filling(color, iX , iY, nX, nY) // Create , position and fill lines with given color
{
			ctx.fillStyle = color;
			ctx.fillRect(iX, iY, nX , nY);

}

			line_filling("#B4B4C6", 470, 300, 10, 55);
			line_filling("#B4B4C6", 470, 380, 10, 45);
			line_filling("blue", 310, 200, 2, 30);
			line_filling("blue", 310, 230,100, 2);
			line_filling("blue", 60, 360, 100, 2);
			line_filling("blue", 580, 202,2, 70);
			line_filling("blue", 530, 271,52, 2);
			line_filling("blue", 189, 308, 2, 50);
			line_filling("blue", 189, 373, 2, 45);
			line_filling('red', 485, 355, 10 , 1);
			line_filling('red', 485, 382, 10 , 1);
			line_filling('red', 490, 355, 1 , 27);

			var x_water = 200;


	//animate();
		
	</script>

	<script>
				var canvas = document.getElementById("myCanvas");
		var ctx = canvas.getContext("2d");
		var x_water = 220;  // Initial Position of water from left
		var y_water = 300; //Initial Position of water from right
		var y_water_2 = 310;



			function animations()	// Animation function to perform desired Animation
			{
		
		id=window.requestAnimationFrame(animations);

		var i = 0
		if(x_water > 459 && x_water <480)	
		{
			
			ctx.fillStyle = "#4679D5";
			ctx.fillRect(x_water, 356, 10, 23 + i);
			i = i + 5;
			x_water = x_water + 1.5;
		}
		else if(x_water<800)
		{
			if(x_water> 420 && x_water < 810 && y_water>215)
			{
				ctx.fillStyle = "#4679D5";
				ctx.fillRect(420, y_water,6, -2);
				y_water = y_water - 0.2;
			}
			if(x_water>520 && x_water < 810 && y_water_2 > 250)
			{
				ctx.fillStyle = "#4679D5";
				ctx.fillRect(520, y_water_2 -10 ,6, -1);
				y_water_2 = y_water_2 - 0.1;
			ctx.fillStyle = 'red';
			ctx.fillRect(485, 355, 10 , 1);
			ctx.font = "5px";
			ctx.fillStyle = 'red';
			ctx.fillStyle = 'red';
			ctx.fillRect(485, 382, 10 , 1);
			ctx.font = "5px";
			ctx.fillRect(490, 355, 1 , 27);
			ctx.font = "5px";
			ctx.fillStyle = "red";
			ctx.fillText("D b", 500, 370);


			}
			ctx.fillStyle = "#4679D5";
			ctx.fillRect(x_water, 301, 10, 124);
			
			for(var i = 220; i<470; i = i + 20)
			for(var j = 301; j<425; j = j + 20)
			{
				ctx.fillStyle = "white";
				ctx.fillRect(i, j, 5,1);	// For white lines in Water
			}
			if(x_water > 460)
			{

			for(var i = 480; i<810; i = i + 20)
			for(var j = 301; j<422; j = j + 20)
			{
				ctx.beginPath();

				ctx.arc(i, j + 3, 2, -0.5* Math.PI, -1.5* Math.PI);
				ctx.strokeStyle = "white";					// For arcs in water
				ctx.stroke();
			}

			}
			
			x_water = x_water + 1;

		}
		else {
			cancelAnimationFrame(id);	// Ends the Animation
		}


	}
	</script>




	<script>

		var canvas1 = document.getElementById("I_O");
		var ctx1 = canvas1.getContext("2d");


		//Positioning of Input(String)
		ctx1.font = "20px Bold"
        ctx1.fillStyle = "Blue";
        var text = ctx1.measureText("Input");
        ctx1.fillText("Input", 200,30);
        ctx1.strokeStyle = "#000000";
        ctx1.strokeRect(200, 33, text.width,0.3);

        //Positioning if Output(String)
		ctx1.font = "20px Bold"
        ctx1.fillStyle = "Blue";
        var text2 = ctx1.measureText("Output");
        ctx1.fillText("Output", 700,30);
        ctx1.strokeStyle = "#000000";
        ctx1.strokeRect(700, 33, text2.width,0.3);

        canvas1.style.left = "170px";
        canvas1.style.top = "630px"
        canvas1.style.position = "absolute";
    </script>

	<button  type = "button" onclick =  "animations()" id = 'child1' >Start</button>  <!--Start Button-->
	<input type="button" value="Re-set" onClick="document.location.reload(true) " id = "child2"> <!--Re-set Button-->

	<!-- Form to give Inputs and get Output-->
<form name = "Calculations" id = "Div">
<label style = "color: blue; font: bold;">H (cm):</label> <input type="number" name ="Height" id = "ht" style = "position:absolute; top:0; left: 120"  >

<label style = "position:absolute; top:0; left: 500; color: blue">Q_a:</label> 
<input type="text" name="q_a" style = "position:absolute; top:0; left: 550"><br><br>

<labe style = "color: blue; font: bold;">Orrifice_Dia (cm):</label> 
<input type="number" name="Orrifice_dia"  style = "position:absolute; top:35; left: 120">

<label  style = "position:absolute; top:50; left: 500">Q_th:</label>
<input type="text" name="q_th"  style = "position:absolute; top:50; left: 550"><br><br>

<label style = "color: blue; font: bold;">Da (cm):</label> 
<input type="number" name="D1"  style = "position:absolute; top:70; left: 120">

<label style = "position:absolute; top:100; left: 500">C_d:</label> 
<input type="text" name="c_d"  style = "position:absolute; top:100; left: 550"><br><br>

<label style = "color: blue; font: bold;">Db (cm):</label> 
<input type="number" name="D2"  style = "position:absolute; top:105; left: 120"><br><br>

<label style = "color: blue; font: bold;">Time (sec):</label>
<input type="number" name="Time" style = "position:absolute; top:140; left: 120">

<input type="button" onClick="Results()" value="Calculate" style = "position:absolute; top:160; left: 350">
</form>

<script>
	
function Results() {
	var h, od, d1, t, d2, Q_th, Q_a, Cd;
		var a=0.36;// Area of the tank
		var g=9.81;//Accleration due to gravity



		
	h = Number(document.Calculations.Height.value); // Height Difference between upstream tap and downstream tap
	od = Number(document.Calculations.Orrifice_dia.value); // Orrifice Diameter
	d1 = Number(document.Calculations.D1.value);// Diameter of the Tube
	t= Number(document.Calculations.Time.value);// Time to collect water for a height difference of h cm, measured in seconds.
	d2 = Number(document.Calculations.D2.value);//Diameter of the orrifice
		if(h == null || od == null || d1 == null || d2 == null || t == null)
		{
			alert("Please make sure that the Input form in filled properly!!");
		}
				if(h == 0 || od == 0 || d1 == 0 || d2 == 0 || t == 0)
		{
			alert("Input cannot be Zero!! or null");
		}
       if(h<0 || od<0 || d1<0 || d2<0 || t<0)
              {
                  alert("Error!!.. Input must not be Negative!!");
              }
        if(h>10000 || od>10000 ||  d1>10000 || d2>10000 || t>1000)
              {
                  alert("Error!!.. Input must not be very large!!");
              }

	if(h>0 && h<=10000 && od>0 && od<=10000 && d1>0 && d1<=10000 && d2>0 && d2<=10000 && t>0 && t<=10000)
	{
			var A1 = Math.PI * 0.25 * d1 * d1; 
	var A2 = Math.PI * 0.25 * d2 * d2;
	var H = h;
	Q_th  = (A1 * A2* Math.sqrt(2* g * H))/Math.sqrt(A1*A1 - A2*A2);
	Q_a = (a * h)/t;
	Cd = Q_a/Q_th;
	document.Calculations.q_th.value = Q_th;
	document.Calculations.q_a.value = Q_a;
	document.Calculations.c_d.value = Cd;
	}
	


}

</script>
	
</body>
</html>


